(()=>{"use strict";var e,t,n,r,o,c,l,a=Object.freeze({gain:.5,numSamples:256}),i=(new Uint8Array(a.numSamples/2),function(e){t.src=e});function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var s,h,f,y,d,g,m=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return"rgba(".concat(e,",").concat(t,",").concat(n,",").concat(r,")")};function v(e){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},v(e)}function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function w(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,k(r.key),r)}}function S(e,t,n){return t&&w(e.prototype,t),n&&w(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function p(e,t,n){return(t=k(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function k(e){var t=function(e,t){if("object"!=v(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=v(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==v(t)?t:t+""}var q=function(){return S((function e(){b(this,e),p(this,"x",void 0),p(this,"y",void 0),p(this,"length",10)}),[{key:"setStartPoint",value:function(e,t){this.x=1*e/5,this.y=2*t/5}},{key:"update",value:function(e,t){e*=.5,this.length=10+e,0==e&&(this.length=0),this.draw(t)}},{key:"draw",value:function(e){s.save(),s.beginPath(),s.fillStyle=e,s.moveTo(this.x,this.y+this.length),s.lineTo(this.x-this.length,this.y),s.lineTo(this.x+this.length,this.y),s.fill(),s.restore()}}])}(),T=function(){return S((function e(){b(this,e),p(this,"x",void 0),p(this,"y",void 0),p(this,"length",10)}),[{key:"setStartPoint",value:function(e,t){this.x=4*e/5,this.y=1*t/2}},{key:"update",value:function(e,t){this.length=e,this.draw(t)}},{key:"draw",value:function(e){s.save(),s.beginPath(),s.fillStyle=e,s.rect(this.x-this.length/2,this.y-this.length/2,this.length,this.length),s.fill(),s.restore()}}])}(),A=new q,P=new T,I=function(e,t){s=e.getContext("2d"),h=e.width,f=e.height,y=function(e,t,n,r,o,c){var l,a=e.createLinearGradient(0,0,0,o),i=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,l=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){a=!0,c=e},f:function(){try{l||null==n.return||n.return()}finally{if(a)throw c}}}}([{percent:.8,color:"black"},{percent:1,color:"white"}]);try{for(i.s();!(l=i.n()).done;){var s=l.value;a.addColorStop(s.percent,s.color)}}catch(e){i.e(e)}finally{i.f()}return a}(s,0,0,0,f),d=t,g=new Uint8Array(d.fftSize/2),A.setStartPoint(h,f),P.setStartPoint(h,f)};function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var C,F,R,j,E,M,O={showGradient:null,showBars:null,showCircles:null,showTriangles:null,showSquares:null,showNoise:null,showInvert:null,showEmboss:null,showLowshelf:null,showHighshelf:null,selectFrequency:null},z=function e(){setTimeout(e),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(e.selectFrequency?d.getByteFrequencyData(g):d.getByteTimeDomainData(g),s.save(),s.fillStyle="black",s.globalAlpha=.1,s.fillRect(0,0,h,f),s.restore(),e.showGradient&&(s.save(),s.fillStyle=y,s.globalAlpha=.3,s.fillRect(0,0,h,f),s.restore()),e.showTriangles)for(var t=0;t<g.length;t++){var n="rgba(".concat(t/10,", ").concat(t/5,", ").concat(t,", 1)");A.update(g[t],n)}if(e.showSquares)for(var r=0;r<g.length;r++){var o="rgba(".concat(r/10,", ").concat(r/5,", ").concat(r,", 1)");P.update(g[r],o)}if(e.showLowshelf){var c=(h-1*g.length-10)/g.length;s.save(),s.fillStyle="rgba(227, 174, 50,0.50)",s.strokeStyle="rgba(0,0,0,0.50)";for(var l=0;l<g.length;l++)s.fillRect(5+l*(c+1),356-g[l],c,400),s.strokeRect(5+l*(c+1),356-g[l],c,400);s.restore()}if(e.showHighshelf){var a=(h-6*g.length-6)/g.length;s.save(),s.fillStyle="rgba(255,255,255,1)",s.strokeStyle="rgba(255,255,255,0.50)";for(var i=0;i<g.length;i++)s.fillRect(3+i*(a+6),-344-g[i],a,400),s.strokeRect(3+i*(a+6),-344-g[i],a,400);s.restore()}if(e.showBars){var u=(h-4*g.length-10)/g.length;s.save(),s.fillStyle="rgba(255,255,255,0.50)",s.strokeStyle="rgba(0,0,0,0.50)";for(var v=0;v<g.length;v++)s.fillRect(5+v*(u+4),356-g[v],u,200),s.strokeRect(5+v*(u+4),356-g[v],u,200);s.restore()}if(e.showCircles){var b=f/4;s.save(),s.globalAlpha=.5;for(var w=0;w<g.length;w++){var S=g[w]/255,p=S*b;s.beginPath(),s.fillStyle=m(255,111,111,.34-S/3),s.arc(h/2,f/2,p,0,2*Math.PI,!1),s.fill(),s.closePath(),s.beginPath(),s.fillStyle=m(0,0,255,.1-S/10),s.arc(h/2,f/2,1.5*p,0,2*Math.PI,!1),s.fill(),s.closePath(),s.beginPath(),s.fillStyle=m(200,200,0,.5-S/5),s.arc(h/2,f/2,.5*p,0,2*Math.PI,!1),s.fill(),s.closePath(),s.restore()}s.restore()}var k=s.getImageData(0,0,h,f),q=k.data,T=q.length,I=k.width;if(e.showEmboss)for(var x=0;x<T;x++)x%4!=3&&(q[x]=127+2*q[x]-q[x+4]-q[x+4*I]);for(var C=0;C<T;C+=4)if(e.showNoise&&Math.random()<.05&&(q[C]=q[C+1]=q[C+2]=0,q[C]=255,q[C+1]=255,q[C+2]=205),e.showInvert){var F=q[C],R=q[C+1],j=q[C+2];q[C]=255-F,q[C+1]=255-R,q[C+2]=255-j}s.putImageData(k,0,0)}(O)};console.log("init called"),console.log("Testing utils.getRandomColor() import: ".concat("rgba(".concat((M=function(){return 185*Math.random()+35})(),",").concat(M(),",").concat(M(),",1)"))),j=function(){var u,s;u=C[0],s=window.AudioContext||window.webkitAudioContext,e=new s,t=new Audio,i(u),n=e.createMediaElementSource(t),(r=e.createAnalyser()).fftSize=a.numSamples,(o=e.createGain()).gain.value=a.gain,(c=e.createBiquadFilter()).type="highshelf",(l=e.createBiquadFilter()).type="lowshelf",n.connect(c),c.connect(l),l.connect(r),r.connect(o),o.connect(e.destination);var h=document.querySelector("canvas");(function(n){document.querySelector("#fs-button").onclick=function(e){var t;console.log("goFullscreen() called"),(t=n).requestFullscreen?t.requestFullscreen():t.mozRequestFullscreen?t.mozRequestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen&&t.webkitRequestFullscreen()};var r=document.querySelector("#play-button");r.onclick=function(n){"suspended"==e.state&&e.resume(),console.log("audioCtx.state after = ".concat(e.state)),"no"==n.target.dataset.playing?(t.play(),n.target.dataset.playing="yes"):(t.pause(),n.target.dataset.playing="no")};var a=document.querySelector("#volume-slider"),u=document.querySelector("#volume-label");a.oninput=function(e){var t;t=e.target.value,t=Number(t),o.gain.value=t,u.innerHTML=Math.round(e.target.value/2*100)},a.dispatchEvent(new Event("input")),document.querySelector("#track-select").onchange=function(e){i(e.target.value),"yes"==r.dataset.playing&&r.dispatchEvent(new MouseEvent("click"))},document.querySelector("#visualizer-select").onchange=function(e){O.selectFrequency=!O.selectFrequency},document.querySelector("#cb-bars").onclick=function(e){O.showBars=e.target.checked},document.querySelector("#cb-circles").onclick=function(e){O.showCircles=e.target.checked},document.querySelector("#cb-triangles").onclick=function(e){O.showTriangles=e.target.checked},document.querySelector("#cb-squares").onclick=function(e){O.showSquares=e.target.checked},document.querySelector("#cb-gradient").onclick=function(e){O.showGradient=e.target.checked},document.querySelector("#cb-noise").onclick=function(e){O.showNoise=e.target.checked},document.querySelector("#cb-emboss").onclick=function(e){O.showEmboss=e.target.checked},document.querySelector("#cb-invert").onclick=function(e){O.showInvert=e.target.checked},document.querySelector("#cb-lowshelf").onclick=function(t){O.showLowshelf=t.target.checked,O.showLowshelf?(l.frequency.setValueAtTime(1e3,e.currentTime),l.gain.setValueAtTime(15,e.currentTime)):l.gain.setValueAtTime(0,e.currentTime)},document.querySelector("#cb-highshelf").onclick=function(t){O.showHighshelf=t.target.checked,O.showHighshelf?(c.frequency.setValueAtTime(1e3,e.currentTime),c.gain.setValueAtTime(-25,e.currentTime)):c.gain.setValueAtTime(0,e.currentTime)}})(h),I(h,r),document.querySelector("#track-select").value=C[0],document.querySelector("#visualizer-select").value=F,document.querySelector("title").textContent=R,z()},(E=new XMLHttpRequest).onload=function(e){console.log("In onload - HTTP Status Code = ".concat(e.target.status));var t=JSON.parse(E.responseText);C=t["Track Locations"],t.Tracks,t["Params Truth Table"].forEach((function(e){var t,n,r=(t=e.split(":"),n=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,c,l,a=[],i=!0,u=!1;try{if(c=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;i=!1}else for(;!(i=(r=c.call(n)).done)&&(a.push(r.value),a.length!==t);i=!0);}catch(e){u=!0,o=e}finally{try{if(!i&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(u)throw o}}return a}}(t,n)||function(e,t){if(e){if("string"==typeof e)return x(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?x(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=r[0],c=r[1],l=o.trim(),a=c.trim();O[l]="true"===a||"false"===a?"true"===a:a})),F=t["Starting Visualizer State"],R=t.Title,document.querySelector("#cb-noise").checked=O.showNoise,document.querySelector("#cb-bars").checked=O.showBars,document.querySelector("#cb-circles").checked=O.showCircles,document.querySelector("#cb-triangles").checked=O.showTriangles,document.querySelector("#cb-squares").checked=O.showSquares,document.querySelector("#cb-gradient").checked=O.showGradient,document.querySelector("#cb-invert").checked=O.showInvert,document.querySelector("#cb-emboss").checked=O.showEmboss,document.querySelector("#cb-lowshelf").checked=O.showLowshelf,document.querySelector("#cb-highshelf").checked=O.showHighshelf,j()},E.onerror=function(e){return console.log("In onerror - HTTP Status Code = ".concat(e.target.status))},E.open("GET","data/av-data.json"),E.send()})();