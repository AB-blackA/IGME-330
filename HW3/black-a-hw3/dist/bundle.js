(()=>{"use strict";var e,t,n,o,c,r,l,s,a,i,u,h,g,d,f,m,y,w,S,b=Object.freeze({gain:.5,numSamples:256}),q=(new Uint8Array(b.numSamples/2),function(e){t.src=e}),v=function(e,t,n,o){return void 0===o&&(o=1),"rgba(".concat(e,",").concat(t,",").concat(n,",").concat(o,")")},k=function(){function e(){this.length=10}return e.prototype.setStartPoint=function(e,t){this.x=1*e/5,this.y=2*t/5},e.prototype.update=function(e,t){e*=.5,this.length=10+e,0==e&&(this.length=0),this.draw(t)},e.prototype.draw=function(e){s.save(),s.beginPath(),s.fillStyle=e,s.moveTo(this.x,this.y+this.length),s.lineTo(this.x-this.length,this.y),s.lineTo(this.x+this.length,this.y),s.fill(),s.restore()},e}(),p=function(){function e(){this.length=10}return e.prototype.setStartPoint=function(e,t){this.x=4*e/5,this.y=1*t/2},e.prototype.update=function(e,t){this.length=e,this.draw(t)},e.prototype.draw=function(e){s.save(),s.beginPath(),s.fillStyle=e,s.rect(this.x-this.length/2,this.y-this.length/2,this.length,this.length),s.fill(),s.restore()},e}(),T=new k,P=new p,F={showGradient:null,showBars:null,showCircles:null,showTriangles:null,showSquares:null,showNoise:null,showInvert:null,showEmboss:null,showLowshelf:null,showHighshelf:null,selectFrequency:null},R=function(){setTimeout(R),function(e){if(e.selectFrequency?h.getByteFrequencyData(g):h.getByteTimeDomainData(g),s.save(),s.fillStyle="black",s.globalAlpha=.1,s.fillRect(0,0,a,i),s.restore(),e.showGradient&&(s.save(),s.fillStyle=u,s.globalAlpha=.3,s.fillRect(0,0,a,i),s.restore()),e.showTriangles)for(var t=0;t<g.length;t++){var n="rgba(".concat(t/10,", ").concat(t/5,", ").concat(t,", 1)");T.update(g[t],n)}if(e.showSquares)for(t=0;t<g.length;t++)n="rgba(".concat(t/10,", ").concat(t/5,", ").concat(t,", 1)"),P.update(g[t],n);if(e.showLowshelf){var o=1,c=5,r=(a-g.length*o-2*c)/g.length,l=400,d=100;for(s.save(),s.fillStyle="rgba(227, 174, 50,0.50)",s.strokeStyle="rgba(0,0,0,0.50)",t=0;t<g.length;t++)s.fillRect(c+t*(r+o),d+256-g[t],r,l),s.strokeRect(c+t*(r+o),d+256-g[t],r,l);s.restore()}if(e.showHighshelf){for(o=6,c=3,r=(a-g.length*o-2*c)/g.length,l=400,d=-600,s.save(),s.fillStyle="rgba(255,255,255,1)",s.strokeStyle="rgba(255,255,255,0.50)",t=0;t<g.length;t++)s.fillRect(c+t*(r+o),d+256-g[t],r,l),s.strokeRect(c+t*(r+o),d+256-g[t],r,l);s.restore()}if(e.showBars){for(o=4,c=5,r=(a-g.length*o-2*c)/g.length,l=200,d=100,s.save(),s.fillStyle="rgba(255,255,255,0.50)",s.strokeStyle="rgba(0,0,0,0.50)",t=0;t<g.length;t++)s.fillRect(c+t*(r+o),d+256-g[t],r,l),s.strokeRect(c+t*(r+o),d+256-g[t],r,l);s.restore()}if(e.showCircles){var f=i/4;for(s.save(),s.globalAlpha=.5,t=0;t<g.length;t++){var m=g[t]/255,y=m*f;s.beginPath(),s.fillStyle=v(255,111,111,.34-m/3),s.arc(a/2,i/2,y,0,2*Math.PI,!1),s.fill(),s.closePath(),s.beginPath(),s.fillStyle=v(0,0,255,.1-m/10),s.arc(a/2,i/2,1.5*y,0,2*Math.PI,!1),s.fill(),s.closePath(),s.beginPath(),s.fillStyle=v(200,200,0,.5-m/5),s.arc(a/2,i/2,.5*y,0,2*Math.PI,!1),s.fill(),s.closePath(),s.restore()}s.restore()}var w=s.getImageData(0,0,a,i),S=w.data,b=S.length,q=w.width;if(e.showEmboss)for(t=0;t<b;t++)t%4!=3&&(S[t]=127+2*S[t]-S[t+4]-S[t+4*q]);for(t=0;t<b;t+=4)if(e.showNoise&&Math.random()<.05&&(S[t]=S[t+1]=S[t+2]=0,S[t]=255,S[t+1]=255,S[t+2]=205),e.showInvert){var k=S[t],p=S[t+1],F=S[t+2];S[t]=255-k,S[t+1]=255-p,S[t+2]=255-F}s.putImageData(w,0,0)}(F)};console.log("init called"),console.log("Testing utils.getRandomColor() import: ".concat("rgba(".concat((S=function(){return 185*Math.random()+35})(),",").concat(S(),",").concat(S(),",1)"))),y=function(){var y,w;y=d[0],w=window.AudioContext,e=new w,t=new Audio,q(y),n=e.createMediaElementSource(t),(o=e.createAnalyser()).fftSize=b.numSamples,(c=e.createGain()).gain.value=b.gain,(r=e.createBiquadFilter()).type="highshelf",(l=e.createBiquadFilter()).type="lowshelf",n.connect(r),r.connect(l),l.connect(o),o.connect(c),c.connect(e.destination);var S=document.querySelector("canvas");(function(n){document.querySelector("#fs-button").onclick=function(e){var t;console.log("goFullscreen() called"),(t=n).requestFullscreen?t.requestFullscreen():t.mozRequestFullscreen?t.mozRequestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen&&t.webkitRequestFullscreen()};var o=document.querySelector("#play-button");o.onclick=function(n){"suspended"==e.state&&e.resume(),console.log("audioCtx.state after = ".concat(e.state)),"no"==o.dataset.playing?(t.play(),o.dataset.playing="yes"):(t.pause(),o.dataset.playing="no")};var s=document.querySelector("#volume-slider"),a=document.querySelector("#volume-label");s.oninput=function(e){var t;t=Number(e.target.value),t=Number(t),c.gain.value=t,a.innerHTML=Math.round(Number(e.target.value)/2*100).toString()},s.dispatchEvent(new Event("input")),document.querySelector("#track-select").onchange=function(e){q(e.target.value),"yes"==o.dataset.playing&&o.dispatchEvent(new MouseEvent("click"))},document.querySelector("#visualizer-select").onchange=function(e){F.selectFrequency=!F.selectFrequency},document.querySelector("#cb-bars").onclick=function(e){F.showBars=e.target.checked},document.querySelector("#cb-circles").onclick=function(e){F.showCircles=e.target.checked},document.querySelector("#cb-triangles").onclick=function(e){F.showTriangles=e.target.checked},document.querySelector("#cb-squares").onclick=function(e){F.showSquares=e.target.checked},document.querySelector("#cb-gradient").onclick=function(e){F.showGradient=e.target.checked},document.querySelector("#cb-noise").onclick=function(e){F.showNoise=e.target.checked},document.querySelector("#cb-emboss").onclick=function(e){F.showEmboss=e.target.checked},document.querySelector("#cb-invert").onclick=function(e){F.showInvert=e.target.checked},document.querySelector("#cb-lowshelf").onclick=function(t){F.showLowshelf=t.target.checked,F.showLowshelf?(l.frequency.setValueAtTime(1e3,e.currentTime),l.gain.setValueAtTime(15,e.currentTime)):l.gain.setValueAtTime(0,e.currentTime)},document.querySelector("#cb-highshelf").onclick=function(t){F.showHighshelf=t.target.checked,F.showHighshelf?(r.frequency.setValueAtTime(1e3,e.currentTime),r.gain.setValueAtTime(-25,e.currentTime)):r.gain.setValueAtTime(0,e.currentTime)}})(S),function(e,t){s=e.getContext("2d"),a=e.width,i=e.height,u=function(e,t,n,o,c,r){for(var l=e.createLinearGradient(0,0,0,c),s=0,a=[{percent:.8,color:"black"},{percent:1,color:"white"}];s<a.length;s++){var i=a[s];l.addColorStop(i.percent,i.color)}return l}(s,0,0,0,i),h=t,g=new Uint8Array(h.fftSize/2),T.setStartPoint(a,i),P.setStartPoint(a,i)}(S,o),document.querySelector("#track-select").value=d[0],document.querySelector("#visualizer-select").value=f,document.querySelector("title").textContent=m,R()},(w=new XMLHttpRequest).onload=function(e){console.log("In onload - HTTP Status Code = ".concat(e.target.status));var t=JSON.parse(w.responseText);d=t["Track Locations"],t.Tracks,t["Params Truth Table"].forEach((function(e){var t=e.split(":"),n=t[0],o=t[1],c=n.trim(),r=o.trim();F[c]="true"===r||"false"===r?"true"===r:r})),f=t["Default Visualizer State"],m=t.Title,document.querySelector("#cb-noise").checked=F.showNoise,document.querySelector("#cb-bars").checked=F.showBars,document.querySelector("#cb-circles").checked=F.showCircles,document.querySelector("#cb-triangles").checked=F.showTriangles,document.querySelector("#cb-squares").checked=F.showSquares,document.querySelector("#cb-gradient").checked=F.showGradient,document.querySelector("#cb-invert").checked=F.showInvert,document.querySelector("#cb-emboss").checked=F.showEmboss,document.querySelector("#cb-lowshelf").checked=F.showLowshelf,document.querySelector("#cb-highshelf").checked=F.showHighshelf,y()},w.onerror=function(e){return console.log("In onerror - HTTP Status Code = ".concat(e.target.status))},w.open("GET","data/av-data.json"),w.send()})();
//# sourceMappingURL=bundle.js.map